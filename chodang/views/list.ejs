<!DOCTYPE html>
<html>
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/chodang/css/chodang_style.css" />

    <title>초당</title>
  </head>
  <body>
    <div>
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link active" href="/">홈으로</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">어떻게 작업할까?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/write">주문하기</a>
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            href="/list"
            tabindex="-1"
            aria-disabled="true"
            >주문 확인</a
          >
        </li>
      </ul>
    </div>
    <ul class="list-group ml-2 mr-3">
      <% for (var i=0; i < posts.length; i++) { %>
      <p>
        <li>
          <p>글 번호 : <%= posts[i]._id %></p>
          <li class="list-group-item">주문자 : <%= posts[i].주문자 %></li>
          <li class="list-group-item">수량 : <%= posts[i].수량 %></li>
          <li class="list-group-item">동의여부 : <%= posts[i].주문동의 %></li>
          <button
            class="delete"
            type="button"
            class="btn btn-danger"
            style="width: 100px"
            data-id="<%= posts[i]._id %>"
          >
            삭제
          </button>
          </p>
      </li>

      <% } %>
    </ul>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>
      $('.delete').click(function (e) {
        var textNumber = e.target.dataset.id;
        var nowClick = $(this);
        $.ajax({
          method: "DELETE",
          url: "/delete",
          data: { _id : textNumber },
        }).done(function(result) {
          // 페이지를 강제로 새로고침 하기
          // 삭제 버튼을 누른 <li> 요소 제거 혹은 안보이게 하기
          console.log('성공했습니다.');
          nowClick.parent('li').fadeOut();
          


        }).fail(function(){

        });
      });
    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
